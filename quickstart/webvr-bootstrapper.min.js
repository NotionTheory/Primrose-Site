!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.AsyncLockRequest=n()}(this,function(){"use strict";function e(e,n){for(var t=0;t<n.length;++t)if(void 0!==e[n[t]])return n[t]}function n(n,t,o,r,i,s,c){var a=e(document,t),u=e(document,o),l=e(document,r),f=e(document.documentElement,i),d=e(document,s),m=null;u=u&&u.substring(2),l=l&&l.substring(2);var p={addChangeListener:function(e,n){return document.addEventListener(u,e,n)},removeChangeListener:function(e){return document.removeEventListener(u,e)},addErrorListener:function(e,n){return document.addEventListener(l,e,n)},removeErrorListener:function(e){return document.removeEventListener(l,e)},withChange:function(e){return new Promise(function(t,o){var r=function(){setTimeout(c),t(p.element)},i=function(e){setTimeout(c),o(e)},s=function(){m&&(clearTimeout(m),m=null)},c=function(){s(),p.removeChangeListener(r),p.removeErrorListener(i)};p.addChangeListener(r,!1),p.addErrorListener(i,!1),e()?(c(),t(p.element)):(s(),m=setTimeout(function(){c(),o(n+" state did not change in allotted time")},1e3))})},request:function(e,t){return c&&(t=c(t)),p.withChange(function(){if(!f)throw new Error("No "+n+" API support.");return!!p.isActive||void(t?e[f](t):isChrome?e[f](window.Element.ALLOW_KEYBOARD_INPUT):e[f]())})},exit:function(){return p.withChange(function(){if(!d)throw new Error("No Fullscreen API support.");return!p.isActive||void document[d]()})}};return Object.defineProperties(p,{element:{get:function(){return document[a]}},isActive:{get:function(){return!!document[a]}}}),p}return n}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.FullScreen=n()}(this,function(){"use strict";var e=AsyncLockRequest("Fullscreen",["fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement"],["onfullscreenchange","onmozfullscreenchange","onwebkitfullscreenchange","onmsfullscreenchange"],["onfullscreenerror","onmozfullscreenerror","onwebkitfullscreenerror","onmsfullscreenerror"],["requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen"],["exitFullscreen","mozExitFullScreen","webkitExitFullscreen","webkitExitFullScreen","msExitFullscreen"],function(e){return e||isChrome&&window.Element.ALLOW_KEYBOARD_INPUT||void 0});return e}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.Orientation=n()}(this,function(){"use strict";function e(){var e=screen.orientation&&screen.orientation.type||screen.mozOrientation||"";if(e.indexOf("landscape")===-1&&(e="landscape-primary"),screen.orientation&&screen.orientation.lock)return screen.orientation.lock(e);if(!screen.mozLockOrientation)return Promise.reject();var n=screen.mozLockOrientation(e);return n?Promise.resolve():void 0}function n(){screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.mozUnlockOrientation&&screen.mozUnlockOrientation()}var t={lock:e,unlock:n};return t}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.PointerLock=n()}(this,function(){"use strict";var e=AsyncLockRequest("Pointer Lock",["pointerLockElement","mozPointerLockElement","webkitPointerLockElement"],["onpointerlockchange","onmozpointerlockchange","onwebkitpointerlockchange"],["onpointerlockerror","onmozpointerlockerror","onwebkitpointerlockerror"],["requestPointerLock","mozRequestPointerLock","webkitRequestPointerLock","webkitRequestPointerLock"],["exitPointerLock","mozExitPointerLock","webkitExitPointerLock","webkitExitPointerLock"]);return e}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.StandardMonitor=n()}(this,function(){"use strict";function e(){}function n(e){return{get:function(){return e}}}function t(t){function o(e){if("left"===e){var n=this.DOMElement&&this.DOMElement.offsetWidth||screen.width,t=this.DOMElement&&this.DOMElement.offsetHeight||screen.height,o=n/t,r=25,i=r*o;return{renderWidth:n*devicePixelRatio,renderHeight:t*devicePixelRatio,offset:new Float32Array([0,0,0]),fieldOfView:{upDegrees:r,downDegrees:r,leftDegrees:i,rightDegrees:i}}}}function r(){return{position:[0,0,0],orientation:[0,0,0,1],linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}}var i=.01,s=1e4,c={},a=[],u=function(e){this.isPresenting||FullScreen.removeChangeListener(u),window.dispatchEvent(new Event("vrdisplaypresentchange"))}.bind(this);Object.defineProperties(c,{hasPosition:n(!1),hasOrientation:n(isMobile),hasExternalDisplay:n(!1),canPresent:n(!0),maxLayers:n(1)}),Object.defineProperties(this,{displayId:n(t&&t.displayId||"N/A"),displayName:n(isMobile&&"Magic Window"||"Standard Monitor"),isConnected:n(!t||t.isConnected),stageParameters:n(t&&t.stageParameters||null),resetPose:n(t&&t.resetPose.bind(t)||e),isPolyfilled:n(t&&t.isPolyfilled),depthNear:{get:function(){return t?t.depthNear:i},set:function(e){t?t.depthNear=e:i=e}},depthFar:{get:function(){return t?t.depthFar:s},set:function(e){t?t.depthFar=e:s=e}},capabilities:n(c),requestAnimationFrame:n(window.requestAnimationFrame.bind(window)),cancelAnimationFrame:n(window.cancelAnimationFrame.bind(window)),submitFrame:n(e),requestPresent:n(function(e){for(var n=0;n<e.length&&n<1;++n)a[n]=e[n];FullScreen.addChangeListener(u);var t=FullScreen.request(e[0].source);return isMobile&&(t=t.then(Orientation.lock)),t}),isPresenting:{get:function(){return t&&t.isPresenting||!t&&FullScreen.isActive}},getLayers:n(function(){return a}),exitPresent:n(function(){a.splice(0);var e=FullScreen.exit();return isMobile&&(e=e.then(Orientation.unlock)),e}),getEyeParameters:n(o),getPose:n(isMobile&&t&&t.getPose.bind(t)||r),getImmediatePose:n(isMobile&&t&&t.getImmediatePose.bind(t)||r)})}return t}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.ViewCameraTransform=n()}(this,function(){"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),t=function(){function t(n){e(this,t),this._display=n}return n(t,null,[{key:"makeTransform",value:function(e,n,o){return{translation:(new THREE.Vector3).fromArray(e.offset),projection:t.fieldOfViewToProjectionMatrix(e.fieldOfView,n,o),viewport:{left:0,top:0,width:e.renderWidth,height:e.renderHeight}}}},{key:"fieldOfViewToProjectionMatrix",value:function(e,n,t){var o=Math.tan(e.upDegrees*Math.PI/180),r=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),c=2/(i+s),a=2/(o+r),u=new THREE.Matrix4;return u.elements[0]=c,u.elements[1]=0,u.elements[2]=0,u.elements[3]=0,u.elements[4]=0,u.elements[5]=a,u.elements[6]=0,u.elements[7]=0,u.elements[8]=-((i-s)*c*.5),u.elements[9]=(o-r)*a*.5,u.elements[10]=-(n+t)/(t-n),u.elements[11]=-1,u.elements[12]=0,u.elements[13]=0,u.elements[14]=-(2*t*n)/(t-n),u.elements[15]=0,u}}]),n(t,[{key:"getTransforms",value:function(e,n){var o=this._display.getEyeParameters("left"),r=this._display.getEyeParameters("right"),i=[t.makeTransform(o,e,n)];r&&i.push(t.makeTransform(r,e,n));for(var s=1;s<i.length;++s)i[s].viewport.left=i[s-1].viewport.left+i[s-1].viewport.width;return i}}]),t}();return t}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.WebVRBootstrapper=n()}(this,function(){"use strict";function e(e){return wrapWebVR(),documentReady().then(function(){return e&&function(n){return loadFiles(e,n)}})}return e}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.documentReady=n()}(this,function(){"use strict";function e(){return new Promise(function(e,n){function t(){var n="complete"===document.readyState;return n&&(document.removeEventListener("readystatechange",t),e()),n}t()||document.addEventListener("readystatechange",t)})}return e}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.isChrome=n()}(this,function(){"use strict";var e=!window.opera&&navigator.userAgent.indexOf(" OPR/")===-1;return e}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.isMobile=n()}(this,function(){"use strict";var e=function(e){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substring(0,4))}(navigator.userAgent||navigator.vendor||window.opera);return e}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.loadFiles=n()}(this,function(){"use strict";function e(e,n,t){var o=new XMLHttpRequest;o.onload=function(){n(o.status<400?o.response:new Error(o.status))},o.open("GET",e),o.onprogress=t,o.send()}function n(t,o,r,i,s,c){if(i<t.length){var a=t[i][0],u=(t[i][1],a.match(/\.\w+$/)[0]||"none"),l=a.match(/(\.\w+)+$/)[0]||"none",f=c;e(a,function(e){if(e instanceof Error)console.error("Failed to load "+a+": "+e.message);else if(".js"===u&&".typeface.js"!==l){var f=document.createElement("script");f.type="text/javascript",f.src=a,f.defer=!1,f.async=!1,document.head.appendChild(f)}n(t,o,r,i+1,s,c)},function(e){return r(c=f+e.loaded,s)})}else o()}function t(t,o,r){function i(e){for(var t=0,i=0;i<e.length;++i)t+=e[i][1];o=o||console.log.bind(console,"File load progress"),n(e,r,o,0,t,0)}t instanceof String||"string"==typeof t?e(t,function(e){i(JSON.parse(e))}):t instanceof Array&&i(t)}function o(e,n){return new Promise(function(o,r){return t(e,n,o)})}return o}),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.wrapWebVR=n()}(this,function(){"use strict";function e(){var e=navigator.getVRDisplays||Promise.resolve.bind(Promise,[]);navigator.getVRDisplays=function(){return e.call(navigator).then(function(e){var n=e.map(function(e){return e instanceof StandardMonitor}).reduce(function(e,n){return e||n},!1);if(!n){for(var t=!1,o=0;o<e.length;++o){var r=e[o],i=r instanceof StandardMonitor;i||"Mouse and Keyboard VRDisplay (webvr-polyfill)"!==r.displayName||(t=!0,e[o]=new StandardMonitor(r))}t||e.unshift(new StandardMonitor(e[0]))}return e})}}return e});